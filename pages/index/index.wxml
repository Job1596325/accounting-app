<!--pages/index/index.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨æœˆä»½åˆ‡æ¢ -->
  <view class="month-selector">
    <text class="month-text">{{currentMonth}}</text>
    <view class="month-nav">
      <button class="month-btn" bindtap="prevMonth">â†</button>
      <button class="month-btn" bindtap="todayMonth">ä»Šæœˆ</button>
      <button class="month-btn" bindtap="nextMonth">â†’</button>
    </view>
  </view>

  <scroll-view scroll-y="true" class="content">
    <!-- ä¸»ç»Ÿè®¡å¡ç‰‡ -->
    <view class="main-stats">
      <view class="stat-row">
        <view class="stat-block">
          <view class="stat-label">æ”¶å…¥</view>
          <view class="stat-value income-text">Â¥{{monthIncome}}</view>
        </view>
        <view class="stat-divider"></view>
        <view class="stat-block">
          <view class="stat-label">æ”¯å‡º</view>
          <view class="stat-value expense-text">Â¥{{monthExpense}}</view>
        </view>
        <view class="stat-divider"></view>
        <view class="stat-block">
          <view class="stat-label">ç»“ä½™</view>
          <view class="stat-value balance-text">Â¥{{monthBalance}}</view>
        </view>
      </view>
    </view>

    <!-- èµ„äº§å¡ç‰‡ -->
    <view class="card">
      <view class="card-header">
        <text class="card-title">è´¦æˆ·èµ„äº§</text>
        <text class="card-total">æ€»è®¡ï¼šÂ¥{{totalAssets}}</text>
      </view>
      <view wx:for="{{accounts}}" wx:key="id" class="asset-item">
        <view class="asset-icon">{{item.icon}}</view>
        <view class="asset-info">
          <text class="asset-name">{{item.name}}</text>
          <view class="asset-bar">
            <view class="asset-fill" style="width:{{item.percentage}}%"></view>
          </view>
        </view>
        <text class="asset-amount">Â¥{{item.balance}}</text>
      </view>
    </view>

    <!-- æ”¯å‡ºåˆ†ç±»ç»Ÿè®¡ -->
    <view class="card" wx:if="{{expenseCategories.length > 0}}">
      <view class="card-title">æ”¯å‡ºåˆ†ç±»</view>
      <view wx:for="{{expenseCategories}}" wx:key="id" class="category-stat">
        <view class="category-header">
          <text class="category-name">{{item.icon}} {{item.name}}</text>
          <text class="category-amount">Â¥{{item.amount}}</text>
        </view>
        <view class="progress-bar">
          <view class="progress-fill" style="width:{{item.percentage}}%"></view>
        </view>
        <text class="category-percentage">{{item.percentage}}%</text>
      </view>
    </view>

    <!-- æœ€è¿‘äº¤æ˜“ -->
    <view class="card">
      <view class="card-header">
        <text class="card-title">æœ€è¿‘äº¤æ˜“</text>
        <navigator url="/pages/list/list" class="view-more">æŸ¥çœ‹å…¨éƒ¨ â†’</navigator>
      </view>
      <block wx:if="{{recentTransactions.length === 0}}">
        <view class="empty-state">
          <view class="empty-icon">ğŸ“</view>
          <view class="empty-title">æš‚æ— äº¤æ˜“è®°å½•</view>
          <view class="empty-desc">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¼€å§‹è®°è´¦</view>
        </view>
      </block>
      <block wx:else>
        <view wx:for="{{recentTransactions}}" wx:key="id" class="list-item" bindtap="editTransaction" data-id="{{item.id}}">
          <view class="list-icon">{{item.icon}}</view>
          <view class="list-info">
            <view class="list-title">{{item.categoryName}}</view>
            <view class="list-desc">{{item.date}}{{item.note ? ' Â· ' + item.note : ''}}</view>
          </view>
          <view class="list-amount {{item.type}}">{{item.type === 'income' ? '+' : '-'}}Â¥{{item.amount}}</view>
        </view>
      </block>
    </view>

    <!-- å¿«é€Ÿæ“ä½œæŒ‰é’® -->
    <view class="action-buttons">
      <button class="btn btn-primary btn-block" bindtap="navigateTo" data-url="/pages/add/add">
        + è®°ä¸€ç¬”
      </button>
    </view>
  </scroll-view>
</view>
