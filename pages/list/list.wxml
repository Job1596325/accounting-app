<!--pages/list/list.wxml-->
<view class="container">
  <scroll-view scroll-y="true" class="content">
    <view class="card">
      <!-- ç­›é€‰æ ‡ç­¾é¡µ -->
      <view class="tabs">
        <view
          class="tab {{currentFilter === 'all' ? 'active' : ''}}"
          bindtap="filterTransactions"
          data-filter="all"
        >
          å…¨éƒ¨
        </view>
        <view
          class="tab {{currentFilter === 'income' ? 'active' : ''}}"
          bindtap="filterTransactions"
          data-filter="income"
        >
          ğŸ’° æ”¶å…¥
        </view>
        <view
          class="tab {{currentFilter === 'expense' ? 'active' : ''}}"
          bindtap="filterTransactions"
          data-filter="expense"
        >
          ğŸ’¸ æ”¯å‡º
        </view>
      </view>

      <!-- ç»Ÿè®¡ä¿¡æ¯ -->
      <view class="stats-info" wx:if="{{transactions.length > 0}}">
        <text>å…± {{transactions.length}} ç¬” | åˆè®¡ï¼šÂ¥{{totalAmount}}</text>
      </view>

      <!-- äº¤æ˜“åˆ—è¡¨ -->
      <block wx:if="{{transactions.length === 0}}">
        <view class="empty-state">
          <view class="empty-icon">ğŸ“‹</view>
          <view class="empty-title">æš‚æ— äº¤æ˜“è®°å½•</view>
          <view class="empty-desc">å¿«å»è®°è´¦å§</view>
        </view>
      </block>

      <block wx:else>
        <!-- æŒ‰æ—¥æœŸåˆ†ç»„ -->
        <view wx:for="{{groupedTransactions}}" wx:key="date" class="date-group">
          <view class="date-header">
            <text>{{item.date}}</text>
            <text class="date-summary">æ”¶å…¥Â¥{{item.income}} | æ”¯å‡ºÂ¥{{item.expense}}</text>
          </view>
          <view wx:for="{{item.transactions}}" wx:key="id" wx:for-item="trans" class="list-item">
            <view class="list-left">
              <view class="list-icon">{{trans.icon}}</view>
              <view class="list-info">
                <view class="list-title">{{trans.categoryName}}</view>
                <view class="list-desc">{{trans.note ? trans.note : ''}}</view>
              </view>
            </view>
            <view class="list-right">
              <view class="list-amount {{trans.type}}">{{trans.type === 'income' ? '+' : '-'}}Â¥{{trans.amount}}</view>
              <view class="list-actions">
                <text class="action-btn" bindtap="editTransaction" data-id="{{trans.id}}">ç¼–è¾‘</text>
                <text class="action-btn delete" bindtap="deleteTransaction" data-id="{{trans.id}}">åˆ é™¤</text>
              </view>
            </view>
          </view>
        </view>
      </block>
    </view>
  </scroll-view>
</view>
